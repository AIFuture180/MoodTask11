<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="MoodTask helps you improve your mood with personalized, science-backed activities.">
    <meta name="keywords" content="MoodTask, mental health, mood tracker, emotional well-being, stress relief">
    <meta name="robots" content="index, follow">
    <title>MoodTask - Activities</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
            color: #333;
        }
        .nav-bar {
            background-color: #fff;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            max-width: 1400px;
            margin: 0 auto;
            left: 0;
            right: 0;
        }
        .nav-bar .logo {
            font-size: 1.5em;
            font-weight: 700;
            color: #4A90E2;
        }
        .nav-bar .nav-links {
            display: flex;
            align-items: center;
            gap: 18px;
            padding-left: 30px;
            padding-right: 20px;
        }
        .nav-bar a {
            padding: 10px 15px;
            text-decoration: none;
            color: #2C3E50;
            font-weight: 400;
            transition: color 0.3s, background-color 0.3s, box-shadow 0.3s;
            border-radius: 5px;
        }
        .nav-bar a:hover {
            background-color: #f0f0f0;
            color: #2C3E50;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .nav-bar a.active {
            background-color: #4A90E2;
            color: white;
            font-weight: 600;
        }
        .nav-bar .dropdown {
            position: relative;
            display: inline-block;
        }
        .nav-bar .dropdown-content {
            display: none;
            position: absolute;
            background-color: #fff;
            min-width: 160px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            z-index: 1;
            border-radius: 5px;
            top: 100%;
            left: 0;
        }
        .nav-bar .dropdown-content a {
            color: #2C3E50;
            padding: 10px 16px;
            text-decoration: none;
            display: block;
            margin: 0;
            line-height: 1.5;
        }
        .nav-bar .dropdown-content a:hover {
            background-color: #f0f0f0;
        }
        .nav-bar .dropdown:hover .dropdown-content {
            display: block;
        }
        .hero {
            background: linear-gradient(135deg, #4A90E2, #2C3E50);
            color: white;
            padding: 100px 20px;
            text-align: center;
            margin-top: 60px;
        }
        .hero h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
        }
        .hero p {
            font-size: 1.2em;
            margin-bottom: 30px;
        }
        .content-wrapper {
            display: flex;
            justify-content: center;
            gap: 30px;
            max-width: 900px;
            margin: 40px auto;
            padding: 0 20px;
        }
        .tools-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            max-width: 600px;
        }
        .tool-button {
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 0.9em;
            transition: transform 0.2s, box-shadow 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            aspect-ratio: 1 / 1;
            width: 150px;
            height: 150px;
            padding: 10px;
            text-align: center;
        }
        .tool-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .tool-button i {
            margin-bottom: 8px;
            font-size: 1.5em;
        }
        .tool-button.breathing {
            background: linear-gradient(135deg, #4A90E2, #6B7280);
        }
        .tool-button.breathing:hover {
            background: linear-gradient(135deg, #3B82F6, #4A5568);
        }
        .tool-button.gratitude {
            background: linear-gradient(135deg, #F4A261, #FF6F61);
        }
        .tool-button.gratitude:hover {
            background: linear-gradient(135deg, #ED8936, #F56565);
        }
        .tool-button.guided-meditation {
            background: linear-gradient(135deg, #9F7AEA, #B794F4);
        }
        .tool-button.guided-meditation:hover {
            background: linear-gradient(135deg, #805AD5, #9F7AEA);
        }
        .tool-button.punching {
            background: linear-gradient(135deg, #FF6F61, #E53E3E);
        }
        .tool-button.punching:hover {
            background: linear-gradient(135deg, #F56565, #C53030);
        }
        .tool-button.stretch {
            background: linear-gradient(135deg, #6B7280, #A0AEC0);
        }
        .tool-button.stretch:hover {
            background: linear-gradient(135deg, #4A5568, #718096);
        }
        .tool-button.doodle {
            background: linear-gradient(135deg, #6B46C1, #805AD5);
        }
        .tool-button.doodle:hover {
            background: linear-gradient(135deg, #553C9A, #6B46C1);
        }
        .tool-button.dance {
            background: linear-gradient(135deg, #ED64A6, #F687B3);
        }
        .tool-button.dance:hover {
            background: linear-gradient(135deg, #F687B3, #ED64A6);
        }
        .tool-button.worry {
            background: linear-gradient(135deg, #4A5568, #718096);
        }
        .tool-button.worry:hover {
            background: linear-gradient(135deg, #2D3748, #4A5568);
        }
        .tool-button.color {
            background: linear-gradient(135deg, #68D391, #48BB78);
        }
        .tool-button.color:hover {
            background: linear-gradient(135deg, #48BB78, #38A169);
        }
        .footer {
            background-color: #333;
            color: white;
            padding: 40px 20px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            text-align: left;
        }
        .footer h3 {
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        .footer a {
            color: #D6D1F5;
            text-decoration: none;
            display: block;
            margin: 5px 0;
        }
        .footer a:hover {
            text-decoration: underline;
        }
        .footer .affiliate-note {
            font-size: 0.8em;
            color: #aaa;
            margin-top: 20px;
            text-align: center;
            width: 100%;
        }
        .footer .connect a {
            padding: 10px 20px;
            margin: 5px 0;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1em;
            display: flex;
            align-items: center;
            gap: 5px;
            text-decoration: none;
        }
        .footer .connect .coffee {
            background-color: #FFC107;
            color: #333;
        }
        .footer .connect .therapy {
            background-color: #4A90E2;
            color: white;
        }
        .footer .connect .mindfulness {
            background-color: #6BCB77;
            color: white;
        }
        .popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .popup-content {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            position: relative;
            text-align: center;
        }
        .close-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
        }
        #breathing-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: #2C3E50;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-size: 1em;
            margin: 20px auto;
            transition: all 0.3s;
        }
        #breathing-circle.inhale { transform: scale(1.2); background: #6B7280; }
        #breathing-circle.hold { transform: scale(1); background: #4A90E2; }
        #breathing-circle.exhale { transform: scale(0.8); background: #2C3E50; }
        .progress-container {
            width: 100%;
            background: #ddd;
            border-radius: 5px;
            margin: 10px 0;
        }
        .progress-bar {
            width: 0;
            height: 10px;
            background: #2C3E50;
            border-radius: 5px;
            transition: width 1s linear;
        }
        #breathing-instruction, #punching-timer, #stretch-prompt, #doodle-timer, #dance-timer, #color-prompt, #guided-meditation-prompt {
            margin: 10px 0;
            font-size: 1em;
        }
        #punching-bag {
            width: 100px;
            height: 150px;
            background: #6B7280;
            border-radius: 20px;
            margin: 20px auto;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-size: 1.5em;
            cursor: pointer;
            transition: transform 0.15s;
        }
        .drawing-tools {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 10px 0;
        }
        #doodle-canvas {
            border: 1px solid #ddd;
            margin: 10px auto;
            display: block;
        }
        #dance-animation {
            margin: 20px 0;
        }
        .bounce {
            animation: bounce 0.5s infinite alternate;
        }
        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-10px); }
        }
        #gratitude-text, #worry-text {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
            margin: 10px 0;
            resize: none;
        }
        .action-button {
            background: #2C3E50;
            color: #fff;
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        #paper-strips-container {
            position: relative;
            height: 60px;
            margin: 10px 0;
        }
        #worry-text.shredding {
            animation: shred-text 0.5s forwards;
        }
        @keyframes shred-text {
            to { opacity: 0; transform: translateY(20px); }
        }
        @keyframes shred {
            to { transform: translateY(100px); opacity: 0; }
        }
        #color-square {
            width: 100px;
            height: 100px;
            margin: 20px auto;
            border-radius: 10px;
        }
        .task-tiles {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 10px 0;
        }
        .task-tile {
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 0.9em;
            transition: transform 0.2s, box-shadow 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            width: 120px;
            height: 80px;
            padding: 10px;
            text-align: center;
        }
        .task-tile:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .task-tile.breathing-type {
            background: linear-gradient(135deg, #4A90E2, #6B7280);
        }
        .task-tile.breathing-type:hover {
            background: linear-gradient(135deg, #3B82F6, #4A5568);
        }
        .task-tile.meditation-type {
            background: linear-gradient(135deg, #9F7AEA, #B794F4);
        }
        .task-tile.meditation-type:hover {
            background: linear-gradient(135deg, #805AD5, #9F7AEA);
        }
        .task-tile.stretch-type {
            background: linear-gradient(135deg, #6B7280, #A0AEC0);
        }
        .task-tile.stretch-type:hover {
            background: linear-gradient(135deg, #4A5568, #718096);
        }
        .task-tile.color-type {
            background: linear-gradient(135deg, #68D391, #48BB78);
        }
        .task-tile.color-type:hover {
            background: linear-gradient(135deg, #48BB78, #38A169);
        }
        #saved-notes-display {
            max-height: 200px;
            overflow-y: auto;
            margin-top: 10px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #f9f9f9;
        }
        #saved-notes-display .note {
            border-bottom: 1px solid #eee;
            padding: 5px 0;
            font-size: 0.9em;
        }
        #saved-notes-display .note:last-child {
            border-bottom: none;
        }
        #saved-notes-display .note-date {
            color: #666;
            font-size: 0.8em;
        }
        @media (max-width: 900px) {
            .content-wrapper {
                gap: 20px;
                max-width: 750px;
            }
        }
        @media (max-width: 600px) {
            .nav-bar {
                flex-direction: column;
                gap: 12px;
                padding: 15px 20px;
            }
            .nav-bar .nav-links {
                flex-direction: column;
                gap: 12px;
                align-items: center;
                width: 100%;
                padding-left: 0;
                padding-right: 0;
            }
            .nav-bar a {
                padding: 12px 20px;
                width: 100%;
                text-align: center;
                box-sizing: border-box;
            }
            .nav-bar .dropdown {
                width: 100%;
            }
            .nav-bar .dropdown-content {
                width: 100%;
                left: 0;
            }
            .hero {
                padding: 60px 15px;
            }
            .hero h1 {
                font-size: 1.8em;
            }
            .content-wrapper {
                flex-direction: column;
                padding: 0 10px;
            }
            .tools-container {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                max-width: 100%;
                margin: 20px auto;
            }
        }
    </style>
</head>
<body>
    <div class="nav-bar">
        <div class="logo">MoodTask</div>
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="calendar.html">Dashboard</a>
            <div class="dropdown">
                <a href="activities.html" class="active">Activities</a>
                <div class="dropdown-content">
                    <a href="activities.html#breathing">Breathing</a>
                    <a href="activities.html#guided-meditation">Guided Meditation</a>
                    <a href="activities.html#punching">Punching Bag</a>
                    <a href="activities.html#stretch">Stretch</a>
                    <a href="activities.html#doodle">Doodle</a>
                    <a href="activities.html#dance">Dance</a>
                    <a href="activities.html#color-focus">Color Focus</a>
                    <a href="activities.html#worry">Worry</a>
                    <a href="activities.html#gratitude">Gratitude</a>
                </div>
            </div>
            <a href="music.html">Mood Music</a>
            <a href="blog.html">Blog</a>
            <a href="privacy.html">Privacy Policy</a>
            <a href="terms.html">Terms of Use</a>
        </div>
    </div>
    <div class="hero">
        <h1>Activities to Transform Your Mood</h1>
        <p>Explore science-backed activities to improve your emotional well-being.</p>
    </div>
    <div class="content-wrapper">
        <div class="tools-container" id="tools-container">
            <button class="tool-button breathing" data-tool="breathing"><i class="fas fa-wind"></i>Breathing Exercise</button>
            <button class="tool-button gratitude" data-tool="gratitude"><i class="fas fa-heart"></i>Gratitude Note</button>
            <button class="tool-button guided-meditation" data-tool="guided-meditation"><i class="fas fa-spa"></i>Guided Meditation</button>
            <button class="tool-button punching" data-tool="punching"><i class="fas fa-fist-raised"></i>Punching Bag</button>
            <button class="tool-button stretch" data-tool="stretch"><i class="fas fa-child"></i>Stretch</button>
            <button class="tool-button doodle" data-tool="doodle"><i class="fas fa-pencil-alt"></i>Doodle</button>
            <button class="tool-button dance" data-tool="dance"><i class="fas fa-music"></i>Dance</button>
            <button class="tool-button worry" data-tool="worry"><i class="fas fa-cut"></i>Worry Shredder</button>
            <button class="tool-button color" data-tool="color"><i class="fas fa-palette"></i>Color Focus</button>
        </div>
    </div>
    <div class="footer">
        <div>
            <h3>MoodTask</h3>
            <p>Transform your mood with science-backed activities designed to improve your emotional well-being.</p>
        </div>
        <div>
            <h3>Quick Links</h3>
            <a href="index.html">Home</a>
            <a href="privacy.html">Privacy Policy</a>
            <a href="terms.html">Terms of Use</a>
        </div>
        <div class="connect">
            <h3>Connect</h3>
            <a href="https://twitter.com/share?url=https://moodtask.org"><i class="fab fa-twitter"></i> Share on Twitter</a>
            <a href="https://www.buymeacoffee.com/moodtask" class="coffee"><i class="fas fa-coffee"></i> Buy Me a Coffee</a>
            <a href="https://www.online-therapy.com/?aff_id=12345" class="therapy">Online Therapy</a>
            <a href="https://www.mindfulness.com/?aff_id=67890" class="mindfulness">Mindfulness</a>
        </div>
        <div class="affiliate-note">
            AFFILIATE DISCLOSURE: Some links on this site are affiliate links. We may earn a commission on purchases at no extra cost to you.<br>
            © 2025 MoodTask. All rights reserved.
        </div>
    </div>

    <div id="breathing-popup" class="popup">
        <div class="popup-content">
            <h4>Breathing Exercise</h4>
            <p>Select a breathing technique to begin:</p>
            <div class="task-tiles" id="breathing-tiles">
                <button class="task-tile breathing-type" onclick="startBreathingTechnique('diaphragmatic')">Diaphragmatic</button>
                <button class="task-tile breathing-type" onclick="startBreathingTechnique('resonance')">Resonance</button>
                <button class="task-tile breathing-type" onclick="startBreathingTechnique('lions-breath')">Lion’s Breath</button>
                <button class="task-tile breathing-type" onclick="startBreathingTechnique('4-7-8')">4-7-8</button>
                <button class="task-tile breathing-type" onclick="startBreathingTechnique('box')">Box Breathing</button>
            </div>
            <div id="breathing-circle" style="display: none;"><span id="breathing-step">Inhale</span></div>
            <p id="breathing-instruction"></p>
            <p class="affirmation">Well done completing the breathing exercise.</p>
            <button class="close-button" onclick="closePopup('breathing')"><i class="fas fa-times"></i></button>
        </div>
    </div>
    <div id="gratitude-popup" class="popup">
        <div class="popup-content">
            <h4>Gratitude Note</h4>
            <p>Write down something you're grateful for:</p>
            <textarea id="gratitude-text" rows="3" placeholder="Today I'm grateful for..."></textarea>
            <button class="action-button" onclick="saveGratitude()"><i class="fas fa-save"></i> Save Gratitude</button>
            <p id="saved-notes-count">You have 0 saved notes.</p>
            <div id="saved-notes-display"></div>
            <p class="affirmation">Your gratitude note has been saved successfully.</p>
            <button class="close-button" onclick="closePopup('gratitude')"><i class="fas fa-times"></i></button>
        </div>
    </div>
    <div id="guided-meditation-popup" class="popup">
        <div class="popup-content">
            <h4>Guided Meditation</h4>
            <p>Select a meditation technique to begin:</p>
            <div class="task-tiles" id="meditation-tiles">
                <button class="task-tile meditation-type" onclick="startMeditationTechnique('breath-awareness')">Breath Awareness</button>
                <button class="task-tile meditation-type" onclick="startMeditationTechnique('body-scan')">Body Scan</button>
                <button class="task-tile meditation-type" onclick="startMeditationTechnique('sensory-grounding')">Sensory Grounding</button>
                <button class="task-tile meditation-type" onclick="startMeditationTechnique('heart-centered')">Heart-Centered</button>
                <button class="task-tile meditation-type" onclick="startMeditationTechnique('mindful-observation')">Mindful Observation</button>
            </div>
            <p id="guided-meditation-prompt"></p>
            <p class="affirmation">Thank you for taking time to center yourself.</p>
            <button class="close-button" onclick="closePopup('guided-meditation')"><i class="fas fa-times"></i></button>
        </div>
    </div>
    <div id="punching-popup" class="popup">
        <div class="popup-content">
            <h4>Punching Bag</h4>
            <p>Release your stress! Tap or click the bag to punch.</p>
            <div id="punching-bag">0</div>
            <div class="progress-container"><div id="punching-progress" class="progress-bar"></div></div>
            <p id="punching-timer">Time remaining: 30s</p>
            <p class="affirmation">Excellent work releasing tension.</p>
            <button class="close-button" onclick="closePopup('punching')"><i class="fas fa-times"></i></button>
        </div>
    </div>
    <div id="stretch-popup" class="popup">
        <div class="popup-content">
            <h4>Stretch</h4>
            <p>Select a stretch to begin:</p>
            <div class="task-tiles" id="stretch-tiles">
                <button class="task-tile stretch-type" onclick="startStretchTechnique('cat-cow')">Cat-Cow</button>
                <button class="task-tile stretch-type" onclick="startStretchTechnique('neck-stretch')">Neck Stretch</button>
                <button class="task-tile stretch-type" onclick="startStretchTechnique('childs-pose')">Child’s Pose</button>
                <button class="task-tile stretch-type" onclick="startStretchTechnique('standing-side-bend')">Standing Side Bend</button>
                <button class="task-tile stretch-type" onclick="startStretchTechnique('seated-forward-fold')">Seated Forward Fold</button>
            </div>
            <p id="stretch-prompt"></p>
            <p class="affirmation">Your body appreciates this care.</p>
            <button class="close-button" onclick="closePopup('stretch')"><i class="fas fa-times"></i></button>
        </div>
    </div>
    <div id="doodle-popup" class="popup">
        <div class="popup-content">
            <h4>Doodle</h4>
            <p>Let your creativity flow! Draw for 90 seconds.</p>
            <div class="drawing-tools">
                <input type="color" id="color-picker" value="#000000">
                <input type="range" id="brush-size" min="1" max="20" value="5">
            </div>
            <canvas id="doodle-canvas" width="400" height="300"></canvas>
            <div class="progress-container"><div id="doodle-progress" class="progress-bar"></div></div>
            <p id="doodle-timer">Time remaining: 90s</p>
            <button class="action-button" onclick="saveDoodle()"><i class="fas fa-download"></i> Save Doodle</button>
            <button class="action-button" onclick="clearCanvas()"><i class="fas fa-trash"></i> Clear</button>
            <p class="affirmation">Your creativity is inspiring.</p>
            <button class="close-button" onclick="closePopup('doodle')"><i class="fas fa-times"></i></button>
        </div>
    </div>
    <div id="dance-popup" class="popup">
        <div class="popup-content">
            <h4>Dance</h4>
            <div id="dance-animation"><i class="fas fa-child fa-4x bounce"></i></div>
            <p id="dance-prompt">Dance prompt will appear here...</p>
            <div class="progress-container"><div id="dance-progress" class="progress-bar"></div></div>
            <p id="dance-timer">Time remaining: 30s</p>
            <p class="affirmation">Thank you for moving with energy.</p>
            <button class="close-button" onclick="closePopup('dance')"><i class="fas fa-times"></i></button>
        </div>
    </div>
    <div id="worry-popup" class="popup">
        <div class="popup-content">
            <h4>Worry Shredder</h4>
            <p>Write down a worry to shred it away:</p>
            <textarea id="worry-text" rows="3" placeholder="Write your worry here..."></textarea>
            <button class="action-button" onclick="shredWorry()"><i class="fas fa-cut"></i> Shred Worry</button>
            <div id="paper-strips-container"></div>
            <p class="affirmation">Your worry has been shredded.</p>
            <button class="close-button" onclick="closePopup('worry')"><i class="fas fa-times"></i></button>
        </div>
    </div>
    <div id="color-popup" class="popup">
        <div class="popup-content">
            <h4>Color Focus</h4>
            <p>Select a color to focus on:</p>
            <div class="task-tiles" id="color-tiles">
                <button class="task-tile color-type" onclick="startColorTechnique('soft-blue')">Soft Blue</button>
                <button class="task-tile color-type" onclick="startColorTechnique('gentle-green')">Gentle Green</button>
                <button class="task-tile color-type" onclick="startColorTechnique('warm-yellow')">Warm Yellow</button>
                <button class="task-tile color-type" onclick="startColorTechnique('calming-purple')">Calming Purple</button>
                <button class="task-tile color-type" onclick="startColorTechnique('soothing-orange')">Soothing Orange</button>
            </div>
            <p id="color-prompt"></p>
            <div id="color-square" style="display: none;"></div>
            <p class="affirmation">Thank you for taking a moment to focus.</p>
            <button class="close-button" onclick="closePopup('color')"><i class="fas fa-times"></i></button>
        </div>
    </div>

    <script>
        // Initialize event listeners for tool buttons
        document.addEventListener('DOMContentLoaded', () => {
            const toolButtons = document.querySelectorAll('.tool-button');
            toolButtons.forEach(button => {
                const tool = button.getAttribute('data-tool');
                button.addEventListener('click', () => openPopup(tool));
            });
            clearOldGratitudeNotes(); // Clear old gratitude notes on page load
            updateSavedNotesCount(); // Update the saved notes count and display on page load
        });

        // Open popup
        function openPopup(tool) {
            const popup = document.getElementById(`${tool}-popup`);
            popup.style.display = 'flex';

            if (tool === 'punching') initPunchingBag();
            if (tool === 'doodle') initDoodle();
            if (tool === 'dance') startDance();
        }

        // Close popup
        function closePopup(tool) {
            const popup = document.getElementById(`${tool}-popup`);
            popup.style.display = 'none';
            if (tool === 'doodle') stopDoodle();
            if (tool === 'breathing') stopBreathing();
        }

        // Breathing exercise
        let breathingInterval = null;
        function startBreathingTechnique(type) {
            const circle = document.getElementById('breathing-circle');
            const stepText = document.getElementById('breathing-step');
            const instruction = document.getElementById('breathing-instruction');
            const tiles = document.getElementById('breathing-tiles');
            let phaseIndex = 0;
            let phaseTime = 0;

            const techniques = {
                'diaphragmatic': {
                    instruction: 'Place a hand on your belly. Inhale deeply through your nose, expanding your belly, then exhale slowly. Practice for 60 seconds.',
                    phases: [
                        { name: 'inhale', duration: 4, text: 'Inhale' },
                        { name: 'hold', duration: 2, text: 'Hold' },
                        { name: 'exhale', duration: 6, text: 'Exhale' }
                    ]
                },
                'resonance': {
                    instruction: 'Breathe smoothly through your nose. Inhale for 5 seconds, exhale for 5 seconds to find your rhythm. Practice for 60 seconds.',
                    phases: [
                        { name: 'inhale', duration: 5, text: 'Inhale' },
                        { name: 'exhale', duration: 5, text: 'Exhale' }
                    ]
                },
                'lions-breath': {
                    instruction: 'Inhale deeply through your nose, then exhale forcefully with a "ha" sound, sticking out your tongue. Practice for 60 seconds.',
                    phases: [
                        { name: 'inhale', duration: 4, text: 'Inhale' },
                        { name: 'hold', duration: 1, text: 'Hold' },
                        { name: 'exhale', duration: 4, text: 'Exhale (ha!)' }
                    ]
                },
                '4-7-8': {
                    instruction: 'Inhale quietly through your nose for 4 seconds, hold for 7 seconds, then exhale through pursed lips with a whooshing sound for 8 seconds. Practice for 60 seconds.',
                    phases: [
                        { name: 'inhale', duration: 4, text: 'Inhale' },
                        { name: 'hold', duration: 7, text: 'Hold' },
                        { name: 'exhale', duration: 8, text: 'Exhale' }
                    ]
                },
                'box': {
                    instruction: 'Inhale through your nose for 4 seconds, hold for 4 seconds, exhale through your nose for 4 seconds, hold again for 4 seconds—like a box pattern. Practice for 60 seconds.',
                    phases: [
                        { name: 'inhale', duration: 4, text: 'Inhale' },
                        { name: 'hold', duration: 4, text: 'Hold' },
                        { name: 'exhale', duration: 4, text: 'Exhale' },
                        { name: 'hold', duration: 4, text: 'Hold' }
                    ]
                }
            };

            const selectedTechnique = techniques[type];
            const phases = selectedTechnique.phases;
            instruction.textContent = selectedTechnique.instruction;
            tiles.style.display = 'none';
            circle.style.display = 'flex';

            if (breathingInterval) clearInterval(breathingInterval);

            breathingInterval = setInterval(() => {
                phaseTime++;
                const currentPhase = phases[phaseIndex];
                if (phaseTime >= currentPhase.duration) {
                    phaseTime = 0;
                    phaseIndex = (phaseIndex + 1) % phases.length;
                }

                const phaseData = phases[phaseIndex];
                circle.className = 'circle ' + phaseData.name;
                stepText.textContent = phaseData.text;
            }, 1000);
        }

        function stopBreathing() {
            if (breathingInterval) clearInterval(breathingInterval);
            breathingInterval = null;
            const tiles = document.getElementById('breathing-tiles');
            const circle = document.getElementById('breathing-circle');
            const instruction = document.getElementById('breathing-instruction');
            tiles.style.display = 'flex';
            circle.style.display = 'none';
            instruction.textContent = 'Select a breathing technique to begin:';
        }

        // Guided Meditation
        function startMeditationTechnique(type) {
            const prompt = document.getElementById('guided-meditation-prompt');
            const tiles = document.getElementById('meditation-tiles');

            const techniques = {
                'breath-awareness': 'Focus on your breath. Inhale for 4 seconds, exhale for 6 seconds, noticing the air moving. Practice for 60 seconds.',
                'body-scan': 'Scan your body from your feet to your head. Notice any tension and let it go. Practice for 60 seconds.',
                'sensory-grounding': 'Notice 3 things you can hear around you. Let the sounds anchor you in the present. Practice for 60 seconds.',
                'heart-centered': 'Place a hand on your heart. Feel its warmth and breathe into this space. Practice for 60 seconds.',
                'mindful-observation': 'Imagine a peaceful place. Picture its details—colors, sounds, and smells. Practice for 60 seconds.'
            };

            prompt.textContent = techniques[type];
            tiles.style.display = 'none';
        }

        // Punching bag
        function initPunchingBag() {
            const bag = document.getElementById('punching-bag');
            const timerText = document.getElementById('punching-timer');
            const progressBar = document.getElementById('punching-progress');
            let count = 0;
            let timeLeft = 30;

            bag.onclick = () => {
                count++;
                bag.textContent = count;
                bag.style.transform = 'rotate(5deg)';
                setTimeout(() => bag.style.transform = 'rotate(-5deg)', 150);
            };

            const punchingInterval = setInterval(() => {
                timeLeft--;
                timerText.textContent = `Time remaining: ${timeLeft}s`;
                progressBar.style.width = `${(30 - timeLeft) / 30 * 100}%`;

                if (timeLeft <= 0) {
                    clearInterval(punchingInterval);
                    bag.onclick = null;
                    timerText.style.display = 'none';
                    progressBar.style.display = 'none';
                    document.querySelector('#punching-popup .affirmation').style.display = 'block';
                }
            }, 1000);
        }

        // Stretch
        function startStretchTechnique(type) {
            const prompt = document.getElementById('stretch-prompt');
            const tiles = document.getElementById('stretch-tiles');

            const stretches = {
                'cat-cow': 'On all fours, inhale and arch your back (Cow), then exhale and round your spine (Cat). Hold for 12 seconds.',
                'neck-stretch': 'Gently tilt your head to the right, bringing your ear toward your shoulder. Hold and breathe for 12 seconds.',
                'childs-pose': 'Kneel, sit back on your heels, and stretch your arms forward, resting your forehead on the ground. Hold for 12 seconds.',
                'standing-side-bend': 'Stand tall, reach your right arm overhead, and gently bend to the left. Switch sides after 6 seconds. Hold for 12 seconds total.',
                'seated-forward-fold': 'Sit with legs extended, reach forward toward your toes, and relax your head. Hold for 12 seconds.'
            };

            prompt.textContent = stretches[type];
            tiles.style.display = 'none';
        }

        // Doodle
        let canvas, ctx, drawing = false;
        function initDoodle() {
            canvas = document.getElementById('doodle-canvas');
            ctx = canvas.getContext('2d');
            const colorPicker = document.getElementById('color-picker');
            const brushSize = document.getElementById('brush-size');
            const timerText = document.getElementById('doodle-timer');
            const progressBar = document.getElementById('doodle-progress');
            let timeLeft = 90;

            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';

            canvas.onmousedown = (e) => {
                drawing = true;
                ctx.beginPath();
                ctx.moveTo(e.offsetX, e.offsetY);
            };
            canvas.onmousemove = (e) => {
                if (drawing) {
                    ctx.strokeStyle = colorPicker.value;
                    ctx.lineWidth = brushSize.value;
                    ctx.lineTo(e.offsetX, e.offsetY);
                    ctx.stroke();
                }
            };
            canvas.onmouseup = () => drawing = false;
            canvas.onmouseleave = () => drawing = false;

            const doodleInterval = setInterval(() => {
                timeLeft--;
                timerText.textContent = `Time remaining: ${timeLeft}s`;
                progressBar.style.width = `${(90 - timeLeft) / 90 * 100}%`;

                if (timeLeft <= 0) {
                    clearInterval(doodleInterval);
                    canvas.onmousedown = null;
                    canvas.onmousemove = null;
                    canvas.onmouseup = null;
                    timerText.style.display = 'none';
                    progressBar.style.display = 'none';
                    document.querySelector('#doodle-popup .affirmation').style.display = 'block';
                }
            }, 1000);
        }

        function saveDoodle() {
            const link = document.createElement('a');
            link.download = 'doodle.png';
            link.href = canvas.toDataURL();
            link.click();
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function stopDoodle() {
            drawing = false;
            canvas.onmousedown = null;
            canvas.onmousemove = null;
            canvas.onmouseup = null;
        }

        // Dance
        function startDance() {
            const prompt = document.getElementById('dance-prompt');
            const timerText = document.getElementById('dance-timer');
            const progressBar = document.getElementById('dance-progress');
            let timeLeft = 30;

            const prompts = [
                'Do a little twirl!',
                'Move your hips side to side!',
                'Raise your arms and sway!'
            ];

            let promptIndex = 0;
            prompt.textContent = prompts[promptIndex];

            const danceInterval = setInterval(() => {
                timeLeft--;
                timerText.textContent = `Time remaining: ${timeLeft}s`;
                progressBar.style.width = `${(30 - timeLeft) / 30 * 100}%`;

                if (timeLeft % 10 === 0) {
                    promptIndex = (promptIndex + 1) % prompts.length;
                    prompt.textContent = prompts[promptIndex];
                }

                if (timeLeft <= 0) {
                    clearInterval(danceInterval);
                    timerText.style.display = 'none';
                    progressBar.style.display = 'none';
                    prompt.style.display = 'none';
                    document.querySelector('#dance-popup .affirmation').style.display = 'block';
                }
            }, 1000);
        }

        // Worry Shredder
        function shredWorry() {
            const worryText = document.getElementById('worry-text');
            const container = document.getElementById('paper-strips-container');
            if (!worryText.value.trim()) return;

            worryText.classList.add('shredding');
            container.innerHTML = '';
            for (let i = 0; i < 5; i++) {
                const strip = document.createElement('div');
                strip.style.position = 'absolute';
                strip.style.width = '10px';
                strip.style.height = '50px';
                strip.style.background = '#ddd';
                strip.style.left = `${i * 15 + 50}px`;
                strip.style.animation = `shred 0.5s forwards ${i * 0.1}s`;
                container.appendChild(strip);
            }
            setTimeout(() => {
                worryText.value = '';
                worryText.classList.remove('shredding');
                document.querySelector('#worry-popup .affirmation').style.display = 'block';
            }, 1000);
        }

        // Color Focus
        function startColorTechnique(type) {
            const square = document.getElementById('color-square');
            const prompt = document.getElementById('color-prompt');
            const tiles = document.getElementById('color-tiles');

            const colors = {
                'soft-blue': { hex: '#A3BFFA', message: 'Focus on this soft blue to calm your mind. Focus for 12 seconds.' },
                'gentle-green': { hex: '#B2F5EA', message: 'Focus on this gentle green to feel balanced. Focus for 12 seconds.' },
                'warm-yellow': { hex: '#FEF9C3', message: 'Focus on this warm yellow to feel uplifted. Focus for 12 seconds.' },
                'calming-purple': { hex: '#D6BCFA', message: 'Focus on this calming purple to spark creativity. Focus for 12 seconds.' },
                'soothing-orange': { hex: '#FBD38D', message: 'Focus on this soothing orange to feel energized. Focus for 12 seconds.' }
            };

            const selectedColor = colors[type];
            square.style.backgroundColor = selectedColor.hex;
            prompt.textContent = selectedColor.message;
            tiles.style.display = 'none';
            square.style.display = 'block';
        }

        // Gratitude Note
        function saveGratitude() {
            const gratitudeText = document.getElementById('gratitude-text');
            if (gratitudeText.value.trim()) {
                const timestamp = Date.now();
                const note = { text: gratitudeText.value, timestamp: timestamp };
                let notes = JSON.parse(localStorage.getItem('gratitude-notes')) || [];
                notes.push(note);
                localStorage.setItem('gratitude-notes', JSON.stringify(notes));
                gratitudeText.value = '';
                document.querySelector('#gratitude-popup .affirmation').style.display = 'block';
                updateSavedNotesCount();
            }
        }

        function clearOldGratitudeNotes() {
            const now = Date.now();
            const oneDayMs = 24 * 60 * 60 * 1000;
            const sevenDaysMs = 7 * oneDayMs;
            let notes = JSON.parse(localStorage.getItem('gratitude-notes')) || [];

            // Check if it's Sunday at 00:00 AM
            const today = new Date();
            if (today.getDay() === 0 && today.getHours() === 0 && today.getMinutes() === 0) {
                notes = [];
                localStorage.setItem('gratitude-notes', JSON.stringify(notes));
                return;
            }

            // Remove notes older than 7 days
            notes = notes.filter(note => {
                const age = now - note.timestamp;
                return age <= sevenDaysMs;
            });

            localStorage.setItem('gratitude-notes', JSON.stringify(notes));
        }

        function updateSavedNotesCount() {
            const notes = JSON.parse(localStorage.getItem('gratitude-notes')) || [];
            const countElement = document.getElementById('saved-notes-count');
            const displayElement = document.getElementById('saved-notes-display');
            countElement.textContent = `You have ${notes.length} saved notes.`;

            // Display saved notes
            displayElement.innerHTML = '';
            if (notes.length === 0) {
                displayElement.innerHTML = '<p>No saved notes yet.</p>';
            } else {
                notes.forEach(note => {
                    const noteElement = document.createElement('div');
                    noteElement.className = 'note';
                    const date = new Date(note.timestamp);
                    noteElement.innerHTML = `
                        <p>${note.text}</p>
                        <p class="note-date">Saved on: ${date.toLocaleString()}</p>
                    `;
                    displayElement.appendChild(noteElement);
                });
            }
        }
    </script>
</body>
</html>
